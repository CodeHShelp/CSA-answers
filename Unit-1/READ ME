This is all the code from 1.9-1.17
